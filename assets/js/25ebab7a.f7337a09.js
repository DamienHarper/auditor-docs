"use strict";(self.webpackChunkauditor_docs=self.webpackChunkauditor_docs||[]).push([[1236],{9510(e,i,n){n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"intro","title":"Introduction","description":"The missing audit log library for PHP","source":"@site/docs/auditor/index.md","sourceDirName":".","slug":"/intro","permalink":"/auditor-docs/auditor/intro","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"intro","title":"Introduction","slug":"/intro"},"sidebar":"auditorSidebar","next":{"title":"Installation","permalink":"/auditor-docs/auditor/getting-started/installation"}}');var r=n(4848),s=n(8453);const d={id:"intro",title:"Introduction",slug:"/intro"},a="auditor",o={},l=[{value:"What is auditor?",id:"what-is-auditor",level:2},{value:"Key Features",id:"key-features",level:3},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Data Flow",id:"data-flow",level:3},{value:"Supported Databases",id:"supported-databases",level:2},{value:"Version Compatibility",id:"version-compatibility",level:2},{value:"Quick Links",id:"quick-links",level:2},{value:"Related Projects",id:"related-projects",level:2},{value:"License",id:"license",level:2}];function c(e){const i={a:"a",blockquote:"blockquote",code:"code",div:"div",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",mermaid:"mermaid",ol:"ol",p:"p",path:"path",strong:"strong",svg:"svg",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"auditor",children:"auditor"})}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"The missing audit log library for PHP"})}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.a,{href:"https://packagist.org/packages/damienharper/auditor",children:(0,r.jsx)(i.img,{src:"https://poser.pugx.org/damienharper/auditor/v/stable",alt:"Latest Stable Version"})}),"\n",(0,r.jsx)(i.a,{href:"https://packagist.org/packages/damienharper/auditor",children:(0,r.jsx)(i.img,{src:"https://poser.pugx.org/damienharper/auditor/license",alt:"License"})}),"\n",(0,r.jsx)(i.a,{href:"https://packagist.org/packages/damienharper/auditor",children:(0,r.jsx)(i.img,{src:"https://poser.pugx.org/damienharper/auditor/downloads",alt:"Total Downloads"})})]}),"\n",(0,r.jsx)(i.h2,{id:"what-is-auditor",children:"What is auditor?"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"auditor"})," is a PHP library that provides an easy and standardized way to collect audit logs. It is designed to track changes made to your entities and persist them as audit trails."]}),"\n",(0,r.jsx)(i.h3,{id:"key-features",children:"Key Features"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\ud83d\udcdd ",(0,r.jsx)(i.strong,{children:"Automatic change tracking"})," - Captures inserts, updates, and deletes automatically"]}),"\n",(0,r.jsxs)(i.li,{children:["\ud83d\udd17 ",(0,r.jsx)(i.strong,{children:"Relationship tracking"})," - Records many-to-many associations and dissociations"]}),"\n",(0,r.jsxs)(i.li,{children:["\ud83d\udc64 ",(0,r.jsx)(i.strong,{children:"User attribution"})," - Records who made the changes and their IP address"]}),"\n",(0,r.jsxs)(i.li,{children:["\ud83d\udd12 ",(0,r.jsx)(i.strong,{children:"Transactional integrity"})," - Audit entries are inserted within the same database transaction"]}),"\n",(0,r.jsxs)(i.li,{children:["\ud83c\udfaf ",(0,r.jsx)(i.strong,{children:"Flexible configuration"})," - Choose which entities and fields to audit"]}),"\n",(0,r.jsxs)(i.li,{children:["\ud83d\udd10 ",(0,r.jsx)(i.strong,{children:"Security controls"})," - Define who can view audit logs"]}),"\n",(0,r.jsxs)(i.li,{children:["\ud83d\uddc4\ufe0f ",(0,r.jsx)(i.strong,{children:"Multi-database support"})," - Store audits in separate databases if needed"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,r.jsx)(i.p,{children:"The library is architected around two core concepts:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Auditing Services"})," - Responsible for collecting audit events when changes occur"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Storage Services"})," - Responsible for persisting audit traces to the database"]}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["These services are provided by ",(0,r.jsx)(i.strong,{children:"Providers"}),". The library ships with a default provider for Doctrine ORM."]}),"\n",(0,r.jsx)(i.mermaid,{value:'flowchart TD\n    APP["Your Application"] --\x3e AUDITOR\n\n    subgraph AUDITOR["AUDITOR"]\n        direction TB\n\n        subgraph CONFIG["Configuration"]\n            direction LR\n            enabled\n            timezone\n            userProvider\n            securityProvider\n            roleChecker\n        end\n\n        subgraph PROVIDER["DoctrineProvider"]\n            direction TB\n\n            subgraph AUDITING["AuditingService(s)"]\n                EMA["EntityManager A\n                (source data)"]\n            end\n\n            subgraph STORAGE["StorageService(s)"]\n                EMX["EntityManager X\n                (audit storage)"]\n            end\n\n            AUDITING --\x3e TP\n            STORAGE --\x3e TP\n\n            TP["TransactionProcessor\n            Track inserts, updates, deletes, relations\n            Build payload (diffs, blame, extra_data = null)"]\n        end\n\n        subgraph EVENTS["EventDispatcher"]\n            direction TB\n            TP --\x3e LE\n\n            LE["LifecycleEvent\n            payload (diffs, blame, extra_data)\n            entity (the audited object)"]\n\n            LE --\x3e LISTENER\n\n            LISTENER["Your Listener(s) \u2014 optional\n            Enrich extra_data from entity state"]:::optional\n        end\n    end\n\n    LISTENER --\x3e DB\n\n    DB[("Audit Tables\n    users_audit, posts_audit, ...\n    Columns: type, diffs, extra_data, blame, ...")]\n\n    classDef optional stroke-dasharray: 5 5'}),"\n",(0,r.jsx)(i.h3,{id:"data-flow",children:"Data Flow"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Entity Change"})," \u2192 Your application modifies an entity via Doctrine"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Detection"})," \u2192 ",(0,r.jsx)(i.code,{children:"AuditingService"})," detects the change through Doctrine events"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Processing"})," \u2192 ",(0,r.jsx)(i.code,{children:"TransactionProcessor"})," computes diffs and prepares audit data (with ",(0,r.jsx)(i.code,{children:"extra_data = null"}),")"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Event"})," \u2192 A ",(0,r.jsx)(i.code,{children:"LifecycleEvent"})," is dispatched with the audit payload and the entity object"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Enrichment"})," ",(0,r.jsx)(i.em,{children:"(optional)"})," \u2192 Your listener(s) inspect the entity and populate ",(0,r.jsx)(i.code,{children:"extra_data"})," in the payload"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Persistence"})," \u2192 ",(0,r.jsx)(i.code,{children:"StorageService"})," persists the audit entry to the database"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"supported-databases",children:"Supported Databases"}),"\n",(0,r.jsx)(i.p,{children:"The DoctrineProvider supports the following RDBMS:"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Database"}),(0,r.jsx)(i.th,{children:"Support Level"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"MySQL"}),(0,r.jsx)(i.td,{children:"\u2705 Full"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"MariaDB"}),(0,r.jsx)(i.td,{children:"\u2705 Full"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"PostgreSQL"}),(0,r.jsx)(i.td,{children:"\u2705 Full"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"SQLite"}),(0,r.jsx)(i.td,{children:"\u2705 Full"})]})]})]}),"\n",(0,r.jsxs)(i.div,{className:"markdown-alert markdown-alert-note",dir:"auto",children:["\n",(0,r.jsxs)(i.p,{className:"markdown-alert-title",dir:"auto",children:[(0,r.jsx)(i.svg,{className:"octicon",viewBox:"0 0 16 16",width:"16",height:"16","aria-hidden":"true",children:(0,r.jsx)(i.path,{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"})}),"NOTE"]}),"\n",(0,r.jsx)(i.p,{children:"The DoctrineProvider should work with any database supported by Doctrine, though only the above are actively tested."}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"version-compatibility",children:"Version Compatibility"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Version"}),(0,r.jsx)(i.th,{children:"Status"}),(0,r.jsx)(i.th,{children:"Requirements"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"4.x"}),(0,r.jsx)(i.td,{children:"Active development \ud83d\ude80"}),(0,r.jsx)(i.td,{children:"PHP >= 8.4, Symfony >= 8.0, Doctrine DBAL >= 4.0, Doctrine ORM >= 3.2"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"3.x"}),(0,r.jsx)(i.td,{children:"Active support"}),(0,r.jsx)(i.td,{children:"PHP >= 8.2, Symfony >= 5.4"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"2.x"}),(0,r.jsx)(i.td,{children:"End of Life"}),(0,r.jsx)(i.td,{children:"PHP >= 7.4, Symfony >= 4.4"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"1.x"}),(0,r.jsx)(i.td,{children:"End of Life"}),(0,r.jsx)(i.td,{children:"PHP >= 7.2, Symfony >= 3.4"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"quick-links",children:"Quick Links"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/auditor-docs/auditor/getting-started/installation",children:"Installation Guide"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/auditor-docs/auditor/getting-started/quick-start",children:"Quick Start"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/auditor-docs/auditor/configuration/",children:"Configuration Reference"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/auditor-docs/auditor/providers/doctrine/",children:"DoctrineProvider"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/auditor-docs/auditor/querying/",children:"Querying Audits"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/auditor-docs/auditor/extra-data",children:"Extra Data"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/auditor-docs/auditor/api/",children:"API Reference"})}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"related-projects",children:"Related Projects"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"https://github.com/DamienHarper/auditor-bundle",children:"auditor-bundle"})})," - Symfony bundle for seamless integration"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"license",children:"License"}),"\n",(0,r.jsxs)(i.p,{children:["This library is released under the ",(0,r.jsx)(i.a,{href:"https://opensource.org/licenses/MIT",children:"MIT License"}),"."]})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,i,n){n.d(i,{R:()=>d,x:()=>a});var t=n(6540);const r={},s=t.createContext(r);function d(e){const i=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);