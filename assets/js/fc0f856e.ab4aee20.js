"use strict";(self.webpackChunkauditor_docs=self.webpackChunkauditor_docs||[]).push([[5530],{8144(e,r,i){i.r(r),i.d(r,{assets:()=>d,contentTitle:()=>s,default:()=>l,frontMatter:()=>c,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"customization/security-provider","title":"Security provider setup","description":"A security provider is a service which goal is to return an array containing the current client IP","source":"@site/auditor-bundle_versioned_docs/version-6.x/customization/security-provider.md","sourceDirName":"customization","slug":"/customization/security-provider","permalink":"/auditor-docs/auditor-bundle/6.x/customization/security-provider","draft":false,"unlisted":false,"tags":[],"version":"6.x","frontMatter":{"title":"Security provider setup"},"sidebar":"docs","previous":{"title":"Role checker setup","permalink":"/auditor-docs/auditor-bundle/6.x/customization/role-checker"},"next":{"title":"User provider setup","permalink":"/auditor-docs/auditor-bundle/6.x/customization/user-provider"}}');var t=i(74848),o=i(28453);const c={title:"Security provider setup"},s=void 0,d={},a=[{value:"Built-in security provider",id:"built-in-security-provider",level:2},{value:"Custom security provider",id:"custom-security-provider",level:2},{value:"Example",id:"example",level:3}];function u(e){const r={br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.p,{children:["A security provider is a service which goal is to return an ",(0,t.jsx)(r.code,{children:"array"})," containing the current client IP\nand firewall name.",(0,t.jsx)(r.br,{}),"\n",(0,t.jsx)(r.code,{children:"auditor"})," then invokes the security provider any time it receives an audit event."]}),"\n",(0,t.jsx)(r.h2,{id:"built-in-security-provider",children:"Built-in security provider"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.code,{children:"auditor"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"auditor-bundle"})," provides a default built-in security provider based on Symfony's ",(0,t.jsx)(r.code,{children:"RequestStack"})," and ",(0,t.jsx)(r.code,{children:"FirewallMap"}),",\nbut if you don't use those components, you can still provide a custom security provider."]}),"\n",(0,t.jsx)(r.h2,{id:"custom-security-provider",children:"Custom security provider"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.code,{children:"auditor"})}),"\n",(0,t.jsxs)(r.p,{children:["First you need to provide a service implementing the ",(0,t.jsx)(r.code,{children:"SecurityProviderInterface"})," interface\nand reference it in the ",(0,t.jsx)(r.code,{children:"dh_auditor.yaml"}),". This service has to be a ",(0,t.jsx)(r.code,{children:"callable"})," and\nreturns security information as an ",(0,t.jsx)(r.code,{children:"array"})," of client IP and firewall name."]}),"\n",(0,t.jsx)(r.h3,{id:"example",children:"Example"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-php",children:"<?php\n\nnamespace App\\Audit\\Security;\n\nuse DH\\Auditor\\Security\\SecurityProviderInterface;\n\nclass SecurityProvider implements SecurityProviderInterface\n{\n    public function __invoke(): array\n    {\n        // ... do your stuff here to get current client IP and firewall name\n        // then return them in an `array` ...\n    }\n}\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"# config/services.yaml\nservices:\n  dh_auditor.security_provider: '@App\\Audit\\SecurityProvider'\n"})}),"\n",(0,t.jsxs)(r.p,{children:["And finally, reference it in the bundle's configuration file ",(0,t.jsx)(r.code,{children:"dh_auditor.yaml"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"# config/packages/dh_auditor.yaml\ndh_auditor:\n    # Invokable service (callable) that provides security information (IP, firewall name, etc)\n    security_provider: 'dh_auditor.security_provider'\n"})})]})}function l(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},28453(e,r,i){i.d(r,{R:()=>c,x:()=>s});var n=i(96540);const t={},o=n.createContext(t);function c(e){const r=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),n.createElement(o.Provider,{value:r},e.children)}}}]);