"use strict";(self.webpackChunkauditor_docs=self.webpackChunkauditor_docs||[]).push([[648],{2187(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"api/index","title":"API Reference","description":"Complete API documentation for all public classes and interfaces","source":"@site/docs/auditor/api/index.md","sourceDirName":"api","slug":"/api/","permalink":"/auditor-docs/auditor/api/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Console Commands","permalink":"/auditor-docs/auditor/commands/"},"next":{"title":"Extra Data","permalink":"/auditor-docs/auditor/extra-data"}}');var r=i(4848),c=i(8453);const a={},l="API Reference",o={},s=[{value:"\ud83d\udcda Core Classes",id:"-core-classes",level:2},{value:"Auditor",id:"auditor",level:3},{value:"Configuration",id:"configuration",level:3},{value:"\ud83d\udd0c Provider Interfaces",id:"-provider-interfaces",level:2},{value:"ProviderInterface",id:"providerinterface",level:3},{value:"ConfigurationInterface",id:"configurationinterface",level:3},{value:"\ud83d\uddc4\ufe0f DoctrineProvider",id:"\ufe0f-doctrineprovider",level:2},{value:"\ud83d\uddc4\ufe0f DoctrineProvider",id:"\ufe0f-doctrineprovider-1",level:3},{value:"\ud83d\uddc4\ufe0f DoctrineProvider Configuration",id:"\ufe0f-doctrineprovider-configuration",level:3},{value:"\ud83d\udd0d Reader &amp; Query",id:"-reader--query",level:2},{value:"Reader",id:"reader",level:3},{value:"Query",id:"query",level:3},{value:"\ud83c\udfaf Filters",id:"-filters",level:2},{value:"FilterInterface",id:"filterinterface",level:3},{value:"SimpleFilter",id:"simplefilter",level:3},{value:"DateRangeFilter",id:"daterangefilter",level:3},{value:"RangeFilter",id:"rangefilter",level:3},{value:"\ud83d\udce6 Models",id:"-models",level:2},{value:"Entry",id:"entry",level:3},{value:"User",id:"user",level:3},{value:"\ud83c\udff7\ufe0f Attributes",id:"\ufe0f-attributes",level:2},{value:"Auditable",id:"auditable",level:3},{value:"Ignore",id:"ignore",level:3},{value:"Security",id:"security",level:3},{value:"\ud83d\udee0\ufe0f Schema Management",id:"\ufe0f-schema-management",level:2},{value:"SchemaManager",id:"schemamanager",level:3},{value:"\ud83d\udce3 Events",id:"-events",level:2},{value:"LifecycleEvent",id:"lifecycleevent",level:3},{value:"\u26a0\ufe0f Exceptions",id:"\ufe0f-exceptions",level:2},{value:"Exception Classes",id:"exception-classes",level:3},{value:"\u2699\ufe0f Services",id:"\ufe0f-services",level:2},{value:"AuditingService",id:"auditingservice",level:3},{value:"StorageService",id:"storageservice",level:3},{value:"Next Steps",id:"next-steps",level:2}];function u(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"api-reference",children:"API Reference"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Complete API documentation for all public classes and interfaces"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This section provides detailed API documentation for all public classes and interfaces."}),"\n",(0,r.jsx)(n.h2,{id:"-core-classes",children:"\ud83d\udcda Core Classes"}),"\n",(0,r.jsx)(n.h3,{id:"auditor",children:"Auditor"}),"\n",(0,r.jsx)(n.p,{children:"The main entry point for the library."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor;\n\nfinal class Auditor\n{\n    public function __construct(Configuration $configuration, EventDispatcherInterface $dispatcher);\n    \n    public function getEventDispatcher(): EventDispatcherInterface;\n    public function getConfiguration(): Configuration;\n    \n    // Provider management\n    public function getProviders(): array;\n    public function getProvider(string $name): ProviderInterface;\n    public function hasProvider(string $name): bool;\n    public function registerProvider(ProviderInterface $provider): self;\n    \n    // Storage control\n    public function enableStorage(ProviderInterface $provider): self;\n    public function disableStorage(ProviderInterface $provider): self;\n    public function isStorageEnabled(ProviderInterface $provider): bool;\n    \n    // Auditing control\n    public function enableAuditing(ProviderInterface $provider): self;\n    public function disableAuditing(ProviderInterface $provider): self;\n    public function isAuditingEnabled(ProviderInterface $provider): bool;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Global auditor configuration."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor;\n\nfinal class Configuration\n{\n    public function __construct(array $options);\n    \n    public function enable(): self;\n    public function disable(): self;\n    public function isEnabled(): bool;\n    \n    public function getTimezone(): string;\n    \n    public function setUserProvider(callable $userProvider): self;\n    public function getUserProvider(): ?callable;\n    \n    public function setSecurityProvider(callable $securityProvider): self;\n    public function getSecurityProvider(): ?callable;\n    \n    public function setRoleChecker(callable $roleChecker): self;\n    public function getRoleChecker(): ?callable;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-provider-interfaces",children:"\ud83d\udd0c Provider Interfaces"}),"\n",(0,r.jsx)(n.h3,{id:"providerinterface",children:"ProviderInterface"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider;\n\ninterface ProviderInterface\n{\n    public function setAuditor(Auditor $auditor): self;\n    public function getAuditor(): Auditor;\n    public function getConfiguration(): ConfigurationInterface;\n    public function isRegistered(): bool;\n    \n    public function registerStorageService(StorageServiceInterface $service): self;\n    public function registerAuditingService(AuditingServiceInterface $service): self;\n    \n    public function persist(LifecycleEvent $event): void;\n    \n    public function getStorageServices(): array;\n    public function getAuditingServices(): array;\n    \n    public function supportsStorage(): bool;\n    public function supportsAuditing(): bool;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configurationinterface",children:"ConfigurationInterface"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider;\n\ninterface ConfigurationInterface\n{\n    // Marker interface\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-doctrineprovider",children:"\ud83d\uddc4\ufe0f DoctrineProvider"}),"\n",(0,r.jsx)(n.h3,{id:"\ufe0f-doctrineprovider-1",children:"\ud83d\uddc4\ufe0f DoctrineProvider"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine;\n\nfinal class DoctrineProvider extends AbstractProvider\n{\n    public function __construct(ConfigurationInterface $configuration);\n    \n    public function getTransactionManager(): TransactionManager;\n    \n    public function isStorageMapperRequired(): bool;\n    \n    public function getAuditingServiceForEntity(string $entity): AuditingService;\n    public function getStorageServiceForEntity(string $entity): StorageService;\n    \n    public function isAuditable(object|string $entity): bool;\n    public function isAudited(object|string $entity): bool;\n    public function isAuditedField(object|string $entity, string $field): bool;\n    \n    public function setStorageMapper(callable $storageMapper): void;\n    \n    public function loadAnnotations(EntityManagerInterface $em, array $entities): self;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\ufe0f-doctrineprovider-configuration",children:"\ud83d\uddc4\ufe0f DoctrineProvider Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine;\n\nfinal class Configuration implements ConfigurationInterface\n{\n    public function __construct(array $options);\n    \n    // Entities\n    public function setEntities(array $entities): self;\n    public function getEntities(): array;\n    public function enableAuditFor(string $entity): self;\n    public function disableAuditFor(string $entity): self;\n    \n    // Viewer\n    public function enableViewer(): self;\n    public function disableViewer(): self;\n    public function isViewerEnabled(): bool;\n    public function setViewerPageSize(int $pageSize): self;\n    public function getViewerPageSize(): int;\n    \n    // Table naming\n    public function getTablePrefix(): string;\n    public function getTableSuffix(): string;\n    \n    // Ignored columns\n    public function getIgnoredColumns(): array;\n    \n    // Storage mapper\n    public function setStorageMapper(callable $mapper): self;\n    public function getStorageMapper(): mixed;\n    \n    // Provider reference\n    public function getProvider(): ?DoctrineProvider;\n    public function setProvider(DoctrineProvider $provider): void;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-reader--query",children:"\ud83d\udd0d Reader & Query"}),"\n",(0,r.jsx)(n.h3,{id:"reader",children:"Reader"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Persistence\\Reader;\n\nfinal readonly class Reader implements ReaderInterface\n{\n    public const int PAGE_SIZE = 50;\n    \n    public function __construct(DoctrineProvider $provider);\n    \n    public function getProvider(): DoctrineProvider;\n    \n    public function createQuery(string $entity, array $options = []): Query;\n    \n    public function getAuditsByTransactionHash(string $transactionHash): array;\n    \n    public function paginate(Query $query, int $page = 1, ?int $pageSize = null): array;\n    \n    public function getEntityTableName(string $entity): string;\n    public function getEntityAuditTableName(string $entity): string;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"query",children:"Query"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Persistence\\Reader;\n\nfinal class Query implements QueryInterface\n{\n    public const string TYPE = 'type';\n    public const string CREATED_AT = 'created_at';\n    public const string TRANSACTION_HASH = 'transaction_hash';\n    public const string OBJECT_ID = 'object_id';\n    public const string USER_ID = 'blame_id';\n    public const string ID = 'id';\n    public const string DISCRIMINATOR = 'discriminator';\n    \n    public function __construct(string $table, Connection $connection, string $timezone);\n    \n    public function execute(): array;\n    public function count(): int;\n    \n    public function addFilter(FilterInterface $filter): self;\n    public function addOrderBy(string $field, string $direction = 'DESC'): self;\n    public function resetOrderBy(): self;\n    public function limit(int $limit, int $offset = 0): self;\n    \n    public function getSupportedFilters(): array;\n    public function getFilters(): array;\n    public function getOrderBy(): array;\n    public function getLimit(): array;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-filters",children:"\ud83c\udfaf Filters"}),"\n",(0,r.jsx)(n.h3,{id:"filterinterface",children:"FilterInterface"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Persistence\\Reader\\Filter;\n\ninterface FilterInterface\n{\n    public function getName(): string;\n    public function getSQL(): array;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"simplefilter",children:"SimpleFilter"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Persistence\\Reader\\Filter;\n\nfinal class SimpleFilter implements FilterInterface\n{\n    public function __construct(string $name, mixed $value);\n    \n    public function getName(): string;\n    public function getValue(): mixed;\n    public function getSQL(): array;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"daterangefilter",children:"DateRangeFilter"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Persistence\\Reader\\Filter;\n\nfinal readonly class DateRangeFilter implements FilterInterface\n{\n    public function __construct(\n        string $name,\n        ?\\DateTimeInterface $minValue,\n        ?\\DateTimeInterface $maxValue = null\n    );\n    \n    public function getName(): string;\n    public function getMinValue(): ?\\DateTimeInterface;\n    public function getMaxValue(): ?\\DateTimeInterface;\n    public function getSQL(): array;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"rangefilter",children:"RangeFilter"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Persistence\\Reader\\Filter;\n\nfinal readonly class RangeFilter implements FilterInterface\n{\n    public function __construct(string $name, mixed $minValue, mixed $maxValue = null);\n    \n    public function getName(): string;\n    public function getMinValue(): mixed;\n    public function getMaxValue(): mixed;\n    public function getSQL(): array;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-models",children:"\ud83d\udce6 Models"}),"\n",(0,r.jsx)(n.h3,{id:"entry",children:"Entry"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Model;\n\nfinal class Entry\n{\n    public static function fromArray(array $row): self;\n    \n    public function getId(): ?int;\n    public function getType(): string;\n    public function getObjectId(): string;\n    public function getDiscriminator(): ?string;\n    public function getTransactionHash(): ?string;\n    public function getDiffs(bool $includeMetadata = false): array;\n    public function getUserId(): int|string|null;\n    public function getUsername(): ?string;\n    public function getUserFqdn(): ?string;\n    public function getUserFirewall(): ?string;\n    public function getIp(): ?string;\n    public function getCreatedAt(): ?\\DateTimeImmutable;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"user",children:"User"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\User;\n\ninterface UserInterface\n{\n    public function getIdentifier(): ?string;\n    public function getUsername(): ?string;\n}\n\nclass User implements UserInterface\n{\n    public function __construct(?string $identifier, ?string $username);\n    \n    public function getIdentifier(): ?string;\n    public function getUsername(): ?string;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-attributes",children:"\ud83c\udff7\ufe0f Attributes"}),"\n",(0,r.jsx)(n.h3,{id:"auditable",children:"Auditable"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Auditing\\Attribute;\n\n#[\\Attribute(\\Attribute::TARGET_CLASS)]\nfinal class Auditable\n{\n    public function __construct(public bool $enabled = true);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"ignore",children:"Ignore"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Auditing\\Attribute;\n\n#[\\Attribute(\\Attribute::TARGET_PROPERTY)]\nfinal class Ignore {}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"security",children:"Security"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Auditing\\Attribute;\n\n#[\\Attribute(\\Attribute::TARGET_CLASS)]\nfinal class Security\n{\n    public const string VIEW_SCOPE = 'view';\n    \n    public function __construct(public array $view);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-schema-management",children:"\ud83d\udee0\ufe0f Schema Management"}),"\n",(0,r.jsx)(n.h3,{id:"schemamanager",children:"SchemaManager"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Persistence\\Schema;\n\nfinal readonly class SchemaManager\n{\n    public function __construct(DoctrineProvider $provider);\n    \n    public function updateAuditSchema(?array $sqls = null, ?callable $callback = null): void;\n    \n    public function getAuditableTableNames(EntityManagerInterface $em): array;\n    public function collectAuditableEntities(): array;\n    public function getUpdateAuditSchemaSql(): array;\n    \n    public function createAuditTable(string $entity, ?Schema $schema = null): Schema;\n    public function updateAuditTable(string $entity, ?Schema $schema = null): Schema;\n    \n    public function resolveTableName(string $tableName, string $namespaceName, AbstractPlatform $platform): string;\n    public function resolveAuditTableName(string $entity, Configuration $config, AbstractPlatform $platform): ?string;\n    public function computeAuditTablename(string $entityTableName, Configuration $config): ?string;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-events",children:"\ud83d\udce3 Events"}),"\n",(0,r.jsx)(n.h3,{id:"lifecycleevent",children:"LifecycleEvent"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Event;\n\nfinal class LifecycleEvent extends AuditEvent\n{\n    public function __construct(array $payload);\n    \n    public function setPayload(array $payload): self;\n    public function getPayload(): array;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-exceptions",children:"\u26a0\ufe0f Exceptions"}),"\n",(0,r.jsx)(n.h3,{id:"exception-classes",children:"Exception Classes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Exception;\n\nclass AccessDeniedException extends \\Exception {}\nclass InvalidArgumentException extends \\Exception {}\nclass MappingException extends \\Exception {}\nclass ProviderException extends \\Exception {}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-services",children:"\u2699\ufe0f Services"}),"\n",(0,r.jsx)(n.h3,{id:"auditingservice",children:"AuditingService"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Service;\n\nfinal class AuditingService extends DoctrineService implements AuditingServiceInterface\n{\n    public function __construct(string $name, EntityManagerInterface $entityManager);\n    \n    public function getName(): string;\n    public function getEntityManager(): EntityManagerInterface;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"storageservice",children:"StorageService"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace DH\\Auditor\\Provider\\Doctrine\\Service;\n\nfinal class StorageService extends DoctrineService implements StorageServiceInterface\n{\n    public function __construct(string $name, EntityManagerInterface $entityManager);\n    \n    public function getName(): string;\n    public function getEntityManager(): EntityManagerInterface;\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\ud83d\ude80 ",(0,r.jsx)(n.a,{href:"/auditor-docs/auditor/getting-started/quick-start",children:"Getting Started Guide"})]}),"\n",(0,r.jsxs)(n.li,{children:["\ud83d\uddc4\ufe0f ",(0,r.jsx)(n.a,{href:"/auditor-docs/auditor/providers/doctrine/",children:"DoctrineProvider Reference"})]}),"\n",(0,r.jsxs)(n.li,{children:["\ud83d\udd0d ",(0,r.jsx)(n.a,{href:"/auditor-docs/auditor/querying/",children:"Querying Audits"})]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>l});var t=i(6540);const r={},c=t.createContext(r);function a(e){const n=t.useContext(c);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);