"use strict";(self.webpackChunkauditor_docs=self.webpackChunkauditor_docs||[]).push([[3197],{5040(e,t,n){n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>d,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>u});const i=JSON.parse('{"id":"getting-started/quick-start","title":"Quick Start Guide","description":"Set up auditing for your Doctrine entities in minutes","source":"@site/docs/auditor/getting-started/quick-start.md","sourceDirName":"getting-started","slug":"/getting-started/quick-start","permalink":"/auditor-docs/auditor/getting-started/quick-start","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Installation","permalink":"/auditor-docs/auditor/getting-started/installation"},"next":{"title":"Configuration Reference","permalink":"/auditor-docs/auditor/configuration/"}}');var r=n(4848),a=n(8453);const s={},d="Quick Start Guide",o={},u=[{value:"\ud83d\udd0d Overview",id:"-overview",level:2},{value:"1\ufe0f\u20e3 Step 1: Create the Auditor",id:"1\ufe0f\u20e3-step-1-create-the-auditor",level:2},{value:"2\ufe0f\u20e3 Step 2: Configure the DoctrineProvider",id:"2\ufe0f\u20e3-step-2-configure-the-doctrineprovider",level:2},{value:"3\ufe0f\u20e3 Step 3: Mark Entities as Auditable",id:"3\ufe0f\u20e3-step-3-mark-entities-as-auditable",level:2},{value:"Using PHP Attributes (Recommended)",id:"using-php-attributes-recommended",level:3},{value:"Available Attributes",id:"available-attributes",level:3},{value:"4\ufe0f\u20e3 Step 4: Create Audit Tables",id:"4\ufe0f\u20e3-step-4-create-audit-tables",level:2},{value:"5\ufe0f\u20e3 Step 5: Start Auditing",id:"5\ufe0f\u20e3-step-5-start-auditing",level:2},{value:"\ud83d\udcd6 Reading Audit Logs",id:"-reading-audit-logs",level:2},{value:"What&#39;s Next?",id:"whats-next",level:2}];function l(e){const t={a:"a",blockquote:"blockquote",code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",path:"path",pre:"pre",strong:"strong",svg:"svg",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"quick-start-guide",children:"Quick Start Guide"})}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Set up auditing for your Doctrine entities in minutes"})}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"This guide will help you set up auditing for your Doctrine entities in minutes."}),"\n",(0,r.jsx)(t.h2,{id:"-overview",children:"\ud83d\udd0d Overview"}),"\n",(0,r.jsx)(t.p,{children:"Setting up auditor involves three main steps:"}),"\n",(0,r.jsx)(t.mermaid,{value:'flowchart LR\n    A["1\ufe0f\u20e3 Configure<br>Auditor"] --\x3e B["2\ufe0f\u20e3 Configure<br>DoctrineProvider"]\n    B --\x3e C["3\ufe0f\u20e3 Mark Entities<br>as Auditable"]\n    C --\x3e D["\ud83c\udf89 Done!"]'}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Configure the Auditor"})," - Set up global options"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Configure the DoctrineProvider"})," - Define which entities to audit"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Mark entities as auditable"})," - Use attributes or configuration"]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"1\ufe0f\u20e3-step-1-create-the-auditor",children:"1\ufe0f\u20e3 Step 1: Create the Auditor"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"<?php\n\nuse DH\\Auditor\\Auditor;\nuse DH\\Auditor\\Configuration;\nuse Symfony\\Component\\EventDispatcher\\EventDispatcher;\n\n// Create the event dispatcher\n$eventDispatcher = new EventDispatcher();\n\n// Create the auditor configuration\n$configuration = new Configuration([\n    'enabled' => true,\n    'timezone' => 'UTC',\n    'user_provider' => null,      // Optional: callable to get current user\n    'security_provider' => null,  // Optional: callable for security context\n    'role_checker' => null,       // Optional: callable to check viewing permissions\n]);\n\n// Create the Auditor instance\n$auditor = new Auditor($configuration, $eventDispatcher);\n"})}),"\n",(0,r.jsx)(t.h2,{id:"2\ufe0f\u20e3-step-2-configure-the-doctrineprovider",children:"2\ufe0f\u20e3 Step 2: Configure the DoctrineProvider"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"<?php\n\nuse DH\\Auditor\\Provider\\Doctrine\\Configuration as DoctrineConfiguration;\nuse DH\\Auditor\\Provider\\Doctrine\\DoctrineProvider;\nuse DH\\Auditor\\Provider\\Doctrine\\Service\\AuditingService;\nuse DH\\Auditor\\Provider\\Doctrine\\Service\\StorageService;\n\n// Create provider configuration\n$providerConfiguration = new DoctrineConfiguration([\n    'table_prefix' => '',\n    'table_suffix' => '_audit',\n    'ignored_columns' => [],       // Columns to ignore globally\n    'entities' => [\n        // Entities configuration (alternative to attributes)\n        App\\Entity\\User::class => [\n            'enabled' => true,\n            'ignored_columns' => ['password'],  // Entity-specific ignored columns\n        ],\n        App\\Entity\\Post::class => [\n            'enabled' => true,\n        ],\n    ],\n]);\n\n// Create the DoctrineProvider\n$provider = new DoctrineProvider($providerConfiguration);\n\n// Register auditing and storage services\n// (typically you use the same EntityManager for both)\n$auditingService = new AuditingService('default', $entityManager);\n$storageService = new StorageService('default', $entityManager);\n\n$provider->registerAuditingService($auditingService);\n$provider->registerStorageService($storageService);\n\n// Register the provider with the Auditor\n$auditor->registerProvider($provider);\n"})}),"\n",(0,r.jsx)(t.h2,{id:"3\ufe0f\u20e3-step-3-mark-entities-as-auditable",children:"3\ufe0f\u20e3 Step 3: Mark Entities as Auditable"}),"\n",(0,r.jsx)(t.h3,{id:"using-php-attributes-recommended",children:"Using PHP Attributes (Recommended)"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"<?php\n\nnamespace App\\Entity;\n\nuse DH\\Auditor\\Provider\\Doctrine\\Auditing\\Annotation\\Auditable;\nuse DH\\Auditor\\Provider\\Doctrine\\Auditing\\Annotation\\Ignore;\nuse DH\\Auditor\\Provider\\Doctrine\\Auditing\\Annotation\\Security;\nuse Doctrine\\ORM\\Mapping as ORM;\n\n#[ORM\\Entity]\n#[Auditable]\n#[Security(view: ['ROLE_ADMIN'])]  // Optional: restrict who can view audits\nclass User\n{\n    #[ORM\\Id]\n    #[ORM\\GeneratedValue]\n    #[ORM\\Column]\n    private ?int $id = null;\n\n    #[ORM\\Column(length: 255)]\n    private string $email;\n\n    #[ORM\\Column(length: 255)]\n    #[Ignore]  // This field won't be audited\n    private string $password;\n\n    #[ORM\\Column(length: 100)]\n    private string $name;\n\n    // ... getters and setters\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"available-attributes",children:"Available Attributes"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Attribute"}),(0,r.jsx)(t.th,{children:"Target"}),(0,r.jsx)(t.th,{children:"Purpose"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"#[Auditable]"})}),(0,r.jsx)(t.td,{children:"Class"}),(0,r.jsx)(t.td,{children:"Marks an entity as auditable"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"#[Ignore]"})}),(0,r.jsx)(t.td,{children:"Property"}),(0,r.jsx)(t.td,{children:"Excludes a field from audit tracking"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"#[Security]"})}),(0,r.jsx)(t.td,{children:"Class"}),(0,r.jsx)(t.td,{children:"Defines roles allowed to view audits"})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"4\ufe0f\u20e3-step-4-create-audit-tables",children:"4\ufe0f\u20e3 Step 4: Create Audit Tables"}),"\n",(0,r.jsxs)(t.div,{className:"markdown-alert markdown-alert-important",dir:"auto",children:["\n",(0,r.jsxs)(t.p,{className:"markdown-alert-title",dir:"auto",children:[(0,r.jsx)(t.svg,{className:"octicon",viewBox:"0 0 16 16",width:"16",height:"16","aria-hidden":"true",children:(0,r.jsx)(t.path,{d:"M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"})}),"IMPORTANT"]}),"\n",(0,r.jsx)(t.p,{children:"Before auditing can work, you need to create the audit tables in your database."}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"# Using the provided command (with auditor-bundle)\nphp bin/console audit:schema:update --force\n\n# Or programmatically\n$schemaManager = new SchemaManager($provider);\n$schemaManager->updateAuditSchema();\n"})}),"\n",(0,r.jsx)(t.h2,{id:"5\ufe0f\u20e3-step-5-start-auditing",children:"5\ufe0f\u20e3 Step 5: Start Auditing"}),"\n",(0,r.jsx)(t.p,{children:"Once configured, the library automatically tracks changes when you persist entities:"}),"\n",(0,r.jsxs)(t.div,{className:"markdown-alert markdown-alert-note",dir:"auto",children:["\n",(0,r.jsxs)(t.p,{className:"markdown-alert-title",dir:"auto",children:[(0,r.jsx)(t.svg,{className:"octicon",viewBox:"0 0 16 16",width:"16",height:"16","aria-hidden":"true",children:(0,r.jsx)(t.path,{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"})}),"NOTE"]}),"\n",(0,r.jsxs)(t.p,{children:["Audit entries are created automatically on ",(0,r.jsx)(t.code,{children:"EntityManager::flush()"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"<?php\n\n// Create a new user\n$user = new User();\n$user->setEmail('john@example.com');\n$user->setName('John Doe');\n\n$entityManager->persist($user);\n$entityManager->flush();  // \u2190 Audit entry is created here\n\n// Update the user\n$user->setName('Jane Doe');\n$entityManager->flush();  // \u2190 Update audit entry is created\n\n// Delete the user\n$entityManager->remove($user);\n$entityManager->flush();  // \u2190 Delete audit entry is created\n"})}),"\n",(0,r.jsx)(t.h2,{id:"-reading-audit-logs",children:"\ud83d\udcd6 Reading Audit Logs"}),"\n",(0,r.jsxs)(t.p,{children:["Use the ",(0,r.jsx)(t.code,{children:"Reader"})," class to query audit entries:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"<?php\n\nuse DH\\Auditor\\Provider\\Doctrine\\Persistence\\Reader\\Reader;\n\n$reader = new Reader($provider);\n\n// Get all audits for the User entity\n$query = $reader->createQuery(User::class);\n$audits = $query->execute();\n\n// Get audits for a specific user ID\n$query = $reader->createQuery(User::class, [\n    'object_id' => 123,\n]);\n$audits = $query->execute();\n\n// Get audits with pagination\n$query = $reader->createQuery(User::class, [\n    'page' => 1,\n    'page_size' => 20,\n]);\n$result = $reader->paginate($query);\n"})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"whats-next",children:"What's Next?"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\u2699\ufe0f ",(0,r.jsx)(t.a,{href:"/auditor-docs/auditor/configuration/",children:"Configuration Reference"})," - Detailed configuration options"]}),"\n",(0,r.jsxs)(t.li,{children:["\ud83c\udff7\ufe0f ",(0,r.jsx)(t.a,{href:"/auditor-docs/auditor/providers/doctrine/attributes",children:"Attributes Reference"})," - Complete attributes documentation"]}),"\n",(0,r.jsxs)(t.li,{children:["\ud83d\udd0d ",(0,r.jsx)(t.a,{href:"/auditor-docs/auditor/querying/",children:"Querying Audits"})," - Advanced query techniques"]}),"\n",(0,r.jsxs)(t.li,{children:["\ud83d\udc64 ",(0,r.jsx)(t.a,{href:"/auditor-docs/auditor/configuration/user-provider",children:"User Attribution"})," - Track who made changes"]}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453(e,t,n){n.d(t,{R:()=>s,x:()=>d});var i=n(6540);const r={},a=i.createContext(r);function s(e){const t=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);