"use strict";(self.webpackChunkauditor_docs=self.webpackChunkauditor_docs||[]).push([[1441],{4170(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>a});const c=JSON.parse('{"id":"customization/role-checker","title":"Role checker setup","description":"A role checker is a service which goal is to return a boolean indicating whether permission to access","source":"@site/auditor-bundle_versioned_docs/version-6.x/customization/role-checker.md","sourceDirName":"customization","slug":"/customization/role-checker","permalink":"/auditor-docs/auditor-bundle/6.x/customization/role-checker","draft":false,"unlisted":false,"tags":[],"version":"6.x","frontMatter":{"title":"Role checker setup"},"sidebar":"docs","previous":{"title":"Contributing","permalink":"/auditor-docs/auditor-bundle/6.x/contributing"},"next":{"title":"Security provider setup","permalink":"/auditor-docs/auditor-bundle/6.x/customization/security-provider"}}');var o=r(4848),t=r(8453);const i={title:"Role checker setup"},s=void 0,l={},a=[{value:"Built-in role checker",id:"built-in-role-checker",level:2},{value:"Custom role checker",id:"custom-role-checker",level:2},{value:"Example",id:"example",level:3}];function d(e){const n={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["A role checker is a service which goal is to return a ",(0,o.jsx)(n.code,{children:"boolean"})," indicating whether permission to access\nan entity's audit logs is granted for the current user."]}),"\n",(0,o.jsx)(n.h2,{id:"built-in-role-checker",children:"Built-in role checker"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"auditor"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"auditor-bundle"})," provides a default built-in role checker based on Symfony's ",(0,o.jsx)(n.code,{children:"Security"}),",\nbut if you don't use this component, you can still provide a custom role checker."]}),"\n",(0,o.jsx)(n.h2,{id:"custom-role-checker",children:"Custom role checker"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"auditor"})}),"\n",(0,o.jsxs)(n.p,{children:["First you need to provide a service implementing the ",(0,o.jsx)(n.code,{children:"RoleCheckerInterface"})," interface\nand reference it in the ",(0,o.jsx)(n.code,{children:"dh_auditor.yaml"}),". This service has to be a ",(0,o.jsx)(n.code,{children:"callable"})," and\nreturns a ",(0,o.jsx)(n.code,{children:"boolean"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:"<?php\n\nnamespace App\\Audit\\Security;\n\nuse DH\\Auditor\\Security\\RoleCheckerInterface;\n\nclass RoleChecker implements RoleCheckerInterface\n{\n    public function __invoke(string $entity, string $scope): bool\n    {\n        // ... do your stuff here to check if access (scope) is granted\n        // then return it as `bool` ...\n    }\n}\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# config/services.yaml\nservices:\n  dh_auditor.role_checker: '@App\\Audit\\RoleChecker'\n"})}),"\n",(0,o.jsxs)(n.p,{children:["And finally, reference it in the bundle's configuration file ",(0,o.jsx)(n.code,{children:"dh_auditor.yaml"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# config/packages/dh_auditor.yaml\ndh_auditor:\n    # Invokable service (callable) that checks roles\n    role_checker: 'dh_auditor.role_checker'\n"})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>i,x:()=>s});var c=r(6540);const o={},t=c.createContext(o);function i(e){const n=c.useContext(t);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),c.createElement(t.Provider,{value:n},e.children)}}}]);