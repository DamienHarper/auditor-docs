"use strict";(self.webpackChunkauditor_docs=self.webpackChunkauditor_docs||[]).push([[7803],{96181(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>s});const r=JSON.parse('{"id":"configuration/general","title":"General configuration","description":"Depending on the Symfony version your application relies, configuration is located in the following file:","source":"@site/auditor-bundle_versioned_docs/version-6.x/configuration/general.md","sourceDirName":"configuration","slug":"/configuration/general","permalink":"/auditor-docs/auditor-bundle/6.x/configuration/general","draft":false,"unlisted":false,"tags":[],"version":"6.x","frontMatter":{"title":"General configuration"},"sidebar":"docs","previous":{"title":"Auditing configuration","permalink":"/auditor-docs/auditor-bundle/6.x/configuration/auditing"},"next":{"title":"Configuration reference","permalink":"/auditor-docs/auditor-bundle/6.x/configuration/reference"}}');var t=i(74848),a=i(28453);const l={title:"General configuration"},d=void 0,o={},s=[{value:"Timezone",id:"timezone",level:2},{value:"Enabling/Disabling auditing (globally)",id:"enablingdisabling-auditing-globally",level:2},{value:"User provider",id:"user-provider",level:2},{value:"Security provider",id:"security-provider",level:2},{value:"Role checker",id:"role-checker",level:2},{value:"Doctrine provider settings",id:"doctrine-provider-settings",level:2},{value:"Enabling/Disabling auditing (per entity)",id:"enablingdisabling-auditing-per-entity",level:3},{value:"Enabling/Disabling audit viewer",id:"enablingdisabling-audit-viewer",level:3},{value:"Inheritance",id:"inheritance",level:3}];function c(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Depending on the Symfony version your application relies, configuration is located in the following file:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["In a Symfony >= 4.0 application: ",(0,t.jsx)(n.code,{children:"config/packages/dh_auditor.yaml"})]}),"\n",(0,t.jsxs)(n.li,{children:["In a Symfony <= 3.4 application: ",(0,t.jsx)(n.code,{children:"app/config/config.yml"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"timezone",children:"Timezone"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"auditor"})}),"\n",(0,t.jsxs)(n.p,{children:["You can configure the timezone the audit ",(0,t.jsx)(n.code,{children:"created_at"})," is generated in. This by default is ",(0,t.jsx)(n.code,{children:"UTC"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"dh_auditor:\n    timezone: 'Europe/London'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"enablingdisabling-auditing-globally",children:"Enabling/Disabling auditing (globally)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"auditor"})}),"\n",(0,t.jsxs)(n.p,{children:["By default, ",(0,t.jsx)(n.code,{children:"auditor-bundle"})," audits every entity ",(0,t.jsx)(n.a,{href:"auditing.html#audited-entities-and-properties",children:"declared auditable"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["It is however possible to disable audits by default. In this case, ",(0,t.jsx)(n.strong,{children:"nothing is audited"}),"\nuntil auditing is enabled ",(0,t.jsx)(n.a,{href:"../usage/enabling-disabling-at-runtime.html#at-runtime-enabledisable",children:"at runtime"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"dh_auditor:\n    enabled: false\n"})}),"\n",(0,t.jsxs)(n.p,{children:["You can also enable or disable the auditing of entities per entity\nand at ",(0,t.jsx)(n.a,{href:"../usage/enabling-disabling-at-runtime.html#at-runtime-enabledisable",children:"runtime"})," if you use the built-in Doctrine provider."]}),"\n",(0,t.jsx)(n.h2,{id:"user-provider",children:"User provider"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"auditor"})}),"\n",(0,t.jsxs)(n.p,{children:["A user provider is a service which goal is to return information about current user.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"auditor"})," then invokes the user provider any time it receives an audit event."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"dh_auditor:\n    # Invokable service (callable) that provides user information\n    user_provider: ~\n"})}),"\n",(0,t.jsx)(n.h2,{id:"security-provider",children:"Security provider"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"auditor"})}),"\n",(0,t.jsxs)(n.p,{children:["A security provider is a service which goal is to return security information such as current client IP, etc.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"auditor"})," then invokes the security provider any time it receives an audit event."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"dh_auditor:\n    # Invokable service (callable) that provides security information (IP, firewall name, etc)\n    security_provider: ~\n"})}),"\n",(0,t.jsx)(n.h2,{id:"role-checker",children:"Role checker"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"auditor"})}),"\n",(0,t.jsxs)(n.p,{children:["A role checker is a service which goal is to return a ",(0,t.jsx)(n.code,{children:"boolean"})," indicating whether permission to access\nan entity's audit logs is granted for the current user."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"dh_auditor:\n    # Invokable service (callable) that checks roles\n    roles_checker: ~\n"})}),"\n",(0,t.jsx)(n.h2,{id:"doctrine-provider-settings",children:"Doctrine provider settings"}),"\n",(0,t.jsx)(n.h3,{id:"enablingdisabling-auditing-per-entity",children:"Enabling/Disabling auditing (per entity)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"doctrine-provider"})}),"\n",(0,t.jsx)(n.p,{children:"This lets you disable audit logging for an entity by default and only enable auditing\nwhen needed for example. Per entity enabling/disabling is done in the configuration file."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"dh_auditor:\n    enabled: true                           # auditing is globally enabled\n    providers:\n        doctrine:\n            entities:\n                App\\Entity\\MyEntity1:\n                    enabled: false          # auditing of this entity is disabled\n                App\\Entity\\MyEntity2: ~     # auditing of this entity is enabled\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In the above example, an audit table will be created for ",(0,t.jsx)(n.code,{children:"MyAuditedEntity1"}),",\nbut audit entries will only be saved when auditing is explicitly enabled ",(0,t.jsx)(n.a,{href:"../usage/enabling-disabling-at-runtime.html#at-runtime-enabledisable",children:"at runtime"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"enablingdisabling-audit-viewer",children:"Enabling/Disabling audit viewer"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"doctrine-provider"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"auditor-bundle"})," provides an ",(0,t.jsx)(n.a,{href:"../usage/viewer.html",children:"audit viewer"})," letting you review the full history of any audited entity.\nThis viewer is disabled by default but can easily be enabled in the configuration file as shown below and can be accessed at ",(0,t.jsx)(n.code,{children:"/audit"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"dh_auditor:\n    providers:\n        doctrine:\n            viewer: true\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If you're using flex, you are done, routes are automatically added to your application's\nrouting configuration (see ",(0,t.jsx)(n.code,{children:"config/routes/dh_auditor.yaml"}),")."]}),"\n",(0,t.jsxs)(n.p,{children:["Otherwise, you have to manually add the following routes to the routing configuration\nof your application (",(0,t.jsx)(n.code,{children:"config/routes/dh_auditor.yaml"}),")."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'dh_auditor:\n    resource: "@DHAuditorBundle/Controller/"\n    type: auditor\n'})}),"\n",(0,t.jsx)(n.h3,{id:"inheritance",children:"Inheritance"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"doctrine-provider"})}),"\n",(0,t.jsx)(n.p,{children:"This bundle supports all of Doctrine inheritance types:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/inheritance-mapping.html#mapped-superclasses",children:"mapped superclass inheritance"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/inheritance-mapping.html#single-table-inheritance",children:"single table inheritance"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/inheritance-mapping.html#class-table-inheritance",children:"class table inheritance"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Note\nConfiguring the root table to be audited does not suffice to get all child tables audited in a\nsingle table inheritance context. You have to configure every child table that needs to be audited as well."})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453(e,n,i){i.d(n,{R:()=>l,x:()=>d});var r=i(96540);const t={},a=r.createContext(t);function l(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);