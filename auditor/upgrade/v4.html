<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-auditor docs-version-current docs-doc-page docs-doc-id-upgrade/v4" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Upgrading to 4.x from 3.x | auditor</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://damienharper.github.io/auditor-docs/auditor/upgrade/v4"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-auditor-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-auditor-current"><meta data-rh="true" property="og:title" content="Upgrading to 4.x from 3.x | auditor"><meta data-rh="true" name="description" content="PHP 8.4+ modernization and new features"><meta data-rh="true" property="og:description" content="PHP 8.4+ modernization and new features"><link data-rh="true" rel="icon" href="/auditor-docs/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://damienharper.github.io/auditor-docs/auditor/upgrade/v4"><link data-rh="true" rel="alternate" href="https://damienharper.github.io/auditor-docs/auditor/upgrade/v4" hreflang="en"><link data-rh="true" rel="alternate" href="https://damienharper.github.io/auditor-docs/auditor/upgrade/v4" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Upgrading to 4.x from 3.x","item":"https://damienharper.github.io/auditor-docs/auditor/upgrade/v4"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-236563744"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-236563744",{anonymize_ip:!0})</script>








<link rel="icon" type="image/svg+xml" href="/auditor-docs/img/favicon.svg">
<link rel="alternate icon" type="image/x-icon" href="/auditor-docs/img/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/auditor-docs/img/apple-touch-icon.png"><link rel="stylesheet" href="/auditor-docs/assets/css/styles.3758bc21.css">
<script src="/auditor-docs/assets/js/runtime~main.edb60df3.js" defer="defer"></script>
<script src="/auditor-docs/assets/js/main.7da45b6b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/auditor-docs/"><div class="navbar__logo"><img src="/auditor-docs/img/logo.svg" alt="auditor logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/auditor-docs/img/logo.svg" alt="auditor logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">auditor</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/auditor-docs/auditor/upgrade/v4">4.x</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/auditor-docs/auditor/upgrade/v4">4.x</a></li><li><a class="dropdown__link" href="/auditor-docs/auditor/3.x">3.x</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/auditor-docs/auditor/intro">auditor</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/auditor-docs/auditor-bundle/intro">7.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/auditor-docs/auditor-bundle/intro">7.x</a></li><li><a class="dropdown__link" href="/auditor-docs/auditor-bundle/6.x">6.x</a></li></ul></div><a class="navbar__item navbar__link" href="/auditor-docs/auditor-bundle/intro">auditor-bundle</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/DamienHarper/auditor" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/auditor-docs/auditor/intro"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/auditor-docs/auditor/getting-started/installation"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/auditor-docs/auditor/configuration"><span title="Configuration" class="categoryLinkLabel_W154">Configuration</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/auditor-docs/auditor/providers/doctrine"><span title="Providers" class="categoryLinkLabel_W154">Providers</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/auditor-docs/auditor/querying"><span title="Querying" class="categoryLinkLabel_W154">Querying</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/auditor-docs/auditor/commands"><span title="Console Commands" class="linkLabel_WmDU">Console Commands</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/auditor-docs/auditor/api"><span title="API Reference" class="linkLabel_WmDU">API Reference</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/auditor-docs/auditor/extra-data"><span title="Extra Data" class="linkLabel_WmDU">Extra Data</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/auditor-docs/auditor/contributing"><span title="Contributing" class="linkLabel_WmDU">Contributing</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/auditor-docs/auditor/upgrade"><span title="Upgrade Guide" class="categoryLinkLabel_W154">Upgrade Guide</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/auditor-docs/auditor/upgrade"><span title="Upgrade Guide" class="linkLabel_WmDU">Upgrade Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/auditor-docs/auditor/upgrade/v3"><span title="Upgrading to 3.x from 2.x" class="linkLabel_WmDU">Upgrading to 3.x from 2.x</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/auditor-docs/auditor/upgrade/v4"><span title="Upgrading to 4.x from 3.x" class="linkLabel_WmDU">Upgrading to 4.x from 3.x</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/auditor-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Upgrade Guide</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Upgrading to 4.x from 3.x</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Upgrading to 4.x from 3.x</h1></header>
<blockquote>
<p><strong>PHP 8.4+ modernization and new features</strong></p>
</blockquote>
<p>This document describes the backward incompatible changes introduced in auditor 4.0 and how to adapt your code.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="Ô∏è-requirements-changes">‚ö†Ô∏è Requirements Changes<a href="#Ô∏è-requirements-changes" class="hash-link" aria-label="Direct link to ‚ö†Ô∏è Requirements Changes" title="Direct link to ‚ö†Ô∏è Requirements Changes" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="php-version">PHP Version<a href="#php-version" class="hash-link" aria-label="Direct link to PHP Version" title="Direct link to PHP Version" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-important" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>IMPORTANT</p>
<p><strong>Minimum PHP version is now 8.4</strong> (was 8.2 in 3.x)</p>
</div>
<p>This is required by Symfony 8.0 and leverages PHP 8.4 features.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="symfony-version">Symfony Version<a href="#symfony-version" class="hash-link" aria-label="Direct link to Symfony Version" title="Direct link to Symfony Version" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-important" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>IMPORTANT</p>
<p><strong>Minimum Symfony version is now 8.0</strong> (was 5.4 in 3.x)</p>
</div>
<p>Support for Symfony 5.4, 6.4, and 7.x has been dropped.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="doctrine-versions">Doctrine Versions<a href="#doctrine-versions" class="hash-link" aria-label="Direct link to Doctrine Versions" title="Direct link to Doctrine Versions" translate="no">‚Äã</a></h3>
<table><thead><tr><th>Package</th><th>3.x Version</th><th>4.x Version</th></tr></thead><tbody><tr><td>Doctrine DBAL</td><td>&gt;= 3.2</td><td>&gt;= 4.0</td></tr><tr><td>Doctrine ORM</td><td>&gt;= 2.13</td><td>&gt;= 3.2</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="phpunit-version">PHPUnit Version<a href="#phpunit-version" class="hash-link" aria-label="Direct link to PHPUnit Version" title="Direct link to PHPUnit Version" translate="no">‚Äã</a></h3>
<p><strong>PHPUnit minimum version is now 12.0</strong> (was 11.0 in 3.x)</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="Ô∏è-removed-methods">üóëÔ∏è Removed Methods<a href="#Ô∏è-removed-methods" class="hash-link" aria-label="Direct link to üóëÔ∏è Removed Methods" title="Direct link to üóëÔ∏è Removed Methods" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="doctrinehelper">DoctrineHelper<a href="#doctrinehelper" class="hash-link" aria-label="Direct link to DoctrineHelper" title="Direct link to DoctrineHelper" translate="no">‚Äã</a></h3>
<p>The following methods have been removed from <code>DH\Auditor\Provider\Doctrine\Persistence\Helper\DoctrineHelper</code>:</p>
<table><thead><tr><th>Removed Method</th><th>Replacement</th></tr></thead><tbody><tr><td><code>DoctrineHelper::createSchemaManager()</code></td><td><code>$connection-&gt;createSchemaManager()</code></td></tr><tr><td><code>DoctrineHelper::introspectSchema()</code></td><td><code>$schemaManager-&gt;introspectSchema()</code></td></tr><tr><td><code>DoctrineHelper::getMigrateToSql()</code></td><td>See migration example below</td></tr></tbody></table>
<p>These methods were compatibility shims for older Doctrine DBAL versions that are no longer needed.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-namespace-changes">üì¶ Namespace Changes<a href="#-namespace-changes" class="hash-link" aria-label="Direct link to üì¶ Namespace Changes" title="Direct link to üì¶ Namespace Changes" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="annotation--attribute">Annotation ‚Üí Attribute<a href="#annotation--attribute" class="hash-link" aria-label="Direct link to Annotation ‚Üí Attribute" title="Direct link to Annotation ‚Üí Attribute" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-tip" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>TIP</p>
<p>The <code>Annotation</code> namespace has been renamed to <code>Attribute</code> to align with PHP 8+ terminology.</p>
</div>
<table><thead><tr><th>Before (3.x)</th><th>After (4.0)</th></tr></thead><tbody><tr><td><code>DH\Auditor\Provider\Doctrine\Auditing\Annotation\Auditable</code></td><td><code>DH\Auditor\Provider\Doctrine\Auditing\Attribute\Auditable</code></td></tr><tr><td><code>DH\Auditor\Provider\Doctrine\Auditing\Annotation\Ignore</code></td><td><code>DH\Auditor\Provider\Doctrine\Auditing\Attribute\Ignore</code></td></tr><tr><td><code>DH\Auditor\Provider\Doctrine\Auditing\Annotation\Security</code></td><td><code>DH\Auditor\Provider\Doctrine\Auditing\Attribute\Security</code></td></tr><tr><td><code>DH\Auditor\Provider\Doctrine\Auditing\Annotation\AnnotationLoader</code></td><td><code>DH\Auditor\Provider\Doctrine\Auditing\Attribute\AttributeLoader</code></td></tr></tbody></table>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Annotation</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> Audit</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Audit</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified punctuation" style="color:#393A34">\</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Auditable</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">MyEntity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Audit</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified punctuation" style="color:#393A34">\</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Ignore</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword type-declaration" style="color:#00009f">string</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$ignoredField</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Attribute</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> Audit</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Audit</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified punctuation" style="color:#393A34">\</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Auditable</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">MyEntity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Audit</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified punctuation" style="color:#393A34">\</span><span class="token attribute attribute-content attribute-class-name class-name class-name-fully-qualified">Ignore</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword type-declaration" style="color:#00009f">string</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$ignoredField</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-model-changes">üìä Model Changes<a href="#-model-changes" class="hash-link" aria-label="Direct link to üìä Model Changes" title="Direct link to üìä Model Changes" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="entry-model---property-hooks-php-84">Entry Model - Property Hooks (PHP 8.4+)<a href="#entry-model---property-hooks-php-84" class="hash-link" aria-label="Direct link to Entry Model - Property Hooks (PHP 8.4+)" title="Direct link to Entry Model - Property Hooks (PHP 8.4+)" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-note" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>NOTE</p>
<p>The <code>Entry</code> model now uses PHP 8.4 property hooks. Getter methods have been replaced by direct property access.</p>
</div>
<table><thead><tr><th>Before (3.x)</th><th>After (4.0)</th></tr></thead><tbody><tr><td><code>$entry-&gt;getId()</code></td><td><code>$entry-&gt;id</code></td></tr><tr><td><code>$entry-&gt;getType()</code></td><td><code>$entry-&gt;type</code></td></tr><tr><td><code>$entry-&gt;getObjectId()</code></td><td><code>$entry-&gt;objectId</code></td></tr><tr><td><code>$entry-&gt;getDiscriminator()</code></td><td><code>$entry-&gt;discriminator</code></td></tr><tr><td><code>$entry-&gt;getTransactionHash()</code></td><td><code>$entry-&gt;transactionHash</code></td></tr><tr><td><code>$entry-&gt;getUserId()</code></td><td><code>$entry-&gt;userId</code></td></tr><tr><td><code>$entry-&gt;getUsername()</code></td><td><code>$entry-&gt;username</code></td></tr><tr><td><code>$entry-&gt;getUserFqdn()</code></td><td><code>$entry-&gt;userFqdn</code></td></tr><tr><td><code>$entry-&gt;getUserFirewall()</code></td><td><code>$entry-&gt;userFirewall</code></td></tr><tr><td><code>$entry-&gt;getIp()</code></td><td><code>$entry-&gt;ip</code></td></tr><tr><td><code>$entry-&gt;getCreatedAt()</code></td><td><code>$entry-&gt;createdAt</code></td></tr><tr><td><em>(new)</em></td><td><code>$entry-&gt;extraData</code></td></tr></tbody></table>
<p><strong>Note:</strong> <code>getDiffs()</code> and <code>getExtraData()</code> methods remain as they contain business logic. <code>extraData</code> is also available as a virtual property.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration---asymmetric-visibility-php-84">Configuration - Asymmetric Visibility (PHP 8.4+)<a href="#configuration---asymmetric-visibility-php-84" class="hash-link" aria-label="Direct link to Configuration - Asymmetric Visibility (PHP 8.4+)" title="Direct link to Configuration - Asymmetric Visibility (PHP 8.4+)" translate="no">‚Äã</a></h3>
<p>The <code>Configuration</code> class now uses PHP 8.4 asymmetric visibility:</p>
<table><thead><tr><th>Before (3.x)</th><th>After (4.0)</th></tr></thead><tbody><tr><td><code>$config-&gt;isEnabled()</code></td><td><code>$config-&gt;enabled</code></td></tr><tr><td><code>$config-&gt;getTimezone()</code></td><td><code>$config-&gt;timezone</code></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="user-model---property-hooks-php-84">User Model - Property Hooks (PHP 8.4+)<a href="#user-model---property-hooks-php-84" class="hash-link" aria-label="Direct link to User Model - Property Hooks (PHP 8.4+)" title="Direct link to User Model - Property Hooks (PHP 8.4+)" translate="no">‚Äã</a></h3>
<p>The <code>UserInterface</code> now uses PHP 8.4 property hooks:</p>
<table><thead><tr><th>Before (3.x)</th><th>After (4.0)</th></tr></thead><tbody><tr><td><code>$user-&gt;getIdentifier()</code></td><td><code>$user-&gt;identifier</code></td></tr><tr><td><code>$user-&gt;getUsername()</code></td><td><code>$user-&gt;username</code></td></tr></tbody></table>
<p>If you have custom <code>UserInterface</code> implementations, update them:</p>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">User</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">UserInterface</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">MyUser</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">UserInterface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">getIdentifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword return-type" style="color:#00009f">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">getUsername</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword return-type" style="color:#00009f">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">User</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">UserInterface</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">MyUser</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">UserInterface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword type-hint" style="color:#00009f">string</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$identifier</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> get </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword type-hint" style="color:#00009f">string</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$username</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> get </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-utf-8-conversion-now-opt-in">üî° UTF-8 Conversion Now Opt-In<a href="#-utf-8-conversion-now-opt-in" class="hash-link" aria-label="Direct link to üî° UTF-8 Conversion Now Opt-In" title="Direct link to üî° UTF-8 Conversion Now Opt-In" translate="no">‚Äã</a></h2>
<div class="markdown-alert markdown-alert-important" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>IMPORTANT</p>
<p>The automatic UTF-8 re-encoding of audit diffs has been removed from the default path.</p>
</div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-changed">What Changed<a href="#what-changed" class="hash-link" aria-label="Direct link to What Changed" title="Direct link to What Changed" translate="no">‚Äã</a></h3>
<p>Previously, auditor always called <code>mb_convert_encoding()</code> recursively on the entire diff array before persisting each audit entry. This guaranteed that any non-UTF-8 byte sequence in entity field values would be sanitized before being stored.</p>
<p>This pass now only runs when the <code>utf8_convert</code> option is explicitly enabled.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="who-is-affected">Who Is Affected<a href="#who-is-affected" class="hash-link" aria-label="Direct link to Who Is Affected" title="Direct link to Who Is Affected" translate="no">‚Äã</a></h3>
<p>You are affected if your application:</p>
<ul>
<li class="">Uses a database connection that was <strong>not</strong> explicitly configured as UTF-8, <strong>and</strong></li>
<li class="">Persists entity fields that may contain non-UTF-8 strings (e.g. data imported from ISO-8859-1 sources, legacy BLOBs, etc.)</li>
</ul>
<p>Applications running on a modern stack (DBAL 4 + PHP 8.4 + UTF-8 database charset) are <strong>not</strong> affected ‚Äî the conversion was already a no-op for them.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-to-fix">How to Fix<a href="#how-to-fix" class="hash-link" aria-label="Direct link to How to Fix" title="Direct link to How to Fix" translate="no">‚Äã</a></h3>
<p>Add <code>&#x27;utf8_convert&#x27; =&gt; true</code> to your <code>DoctrineProvider</code> configuration:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Configuration</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$configuration</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Configuration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ... other options ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;utf8_convert&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token constant boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-the-default-is-false">Why the Default Is <code>false</code><a href="#why-the-default-is-false" class="hash-link" aria-label="Direct link to why-the-default-is-false" title="Direct link to why-the-default-is-false" translate="no">‚Äã</a></h3>
<p>DBAL 4 mandates PHP 8.4+ and enforces UTF-8 database connections. Traversing and re-encoding every diff array on every flush was unnecessary overhead for the vast majority of users. The option is preserved for applications that still process legacy non-UTF-8 data.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-new-extra_data-column">üÜï New <code>extra_data</code> Column<a href="#-new-extra_data-column" class="hash-link" aria-label="Direct link to -new-extra_data-column" title="Direct link to -new-extra_data-column" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="schema-change">Schema Change<a href="#schema-change" class="hash-link" aria-label="Direct link to Schema Change" title="Direct link to Schema Change" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-important" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>IMPORTANT</p>
<p>A new nullable JSON column <code>extra_data</code> has been added to all audit tables. Run the schema update command after upgrading.</p>
</div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">php bin/console audit:schema:update --dump-sql   </span><span class="token comment" style="color:#999988;font-style:italic"># Preview</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">php bin/console audit:schema:update </span><span class="token parameter variable" style="color:#36acaa">--force</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># Apply</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="two-ways-to-populate-extra_data">Two ways to populate <code>extra_data</code><a href="#two-ways-to-populate-extra_data" class="hash-link" aria-label="Direct link to two-ways-to-populate-extra_data" title="Direct link to two-ways-to-populate-extra_data" translate="no">‚Äã</a></h3>
<p><strong>Option 1 ‚Äî Global provider (new in 4.0):</strong> set a callable on <code>Configuration</code> once and it runs automatically for every audit entry produced during a flush:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$configuration</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">setExtraDataProvider</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword return-type" style="color:#00009f">array</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;ip&#x27;</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">requestStack</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getCurrentRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?-&gt;</span><span class="token function" style="color:#d73a49">getClientIp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;role&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">security</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?-&gt;</span><span class="token function" style="color:#d73a49">getRoles</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>Option 2 ‚Äî Per-entity listener:</strong> <code>LifecycleEvent</code> now exposes <code>$event-&gt;entity</code> (the audited object), allowing listeners to add entity-specific context:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name">AsEventListener</span><span class="token attribute attribute-content punctuation" style="color:#393A34">(</span><span class="token attribute attribute-content attribute-class-name class-name">event</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content attribute-class-name class-name">LifecycleEvent</span><span class="token attribute attribute-content operator" style="color:#393A34">::</span><span class="token attribute attribute-content constant" style="color:#36acaa">class</span><span class="token attribute attribute-content punctuation" style="color:#393A34">,</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content attribute-class-name class-name">priority</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content number" style="color:#36acaa">10</span><span class="token attribute attribute-content punctuation" style="color:#393A34">)</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">AuditExtraDataListener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">__invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name type-declaration">LifecycleEvent</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword return-type" style="color:#00009f">void</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token variable" style="color:#36acaa">$payload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$event</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getPayload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token class-name static-context">User</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$event</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">entity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token variable" style="color:#36acaa">$payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;extra_data&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">json_encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;department&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$event</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">entity</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getDepartment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">JSON_THROW_ON_ERROR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token variable" style="color:#36acaa">$event</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">setPayload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The provider runs first; the listener can override or extend its output. See the <a class="" href="/auditor-docs/auditor/extra-data">Extra Data guide</a> for precedence rules, merging strategies, and caveats.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-transactiontype-enum">üî¢ TransactionType Enum<a href="#-transactiontype-enum" class="hash-link" aria-label="Direct link to üî¢ TransactionType Enum" title="Direct link to üî¢ TransactionType Enum" translate="no">‚Äã</a></h2>
<div class="markdown-alert markdown-alert-tip" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>TIP</p>
<p>Transaction type constants have been replaced by a backed enum for better type safety.</p>
</div>
<table><thead><tr><th>Before (3.x)</th><th>After (4.0)</th></tr></thead><tbody><tr><td><code>Transaction::INSERT</code></td><td><code>TransactionType::Insert-&gt;value</code></td></tr><tr><td><code>Transaction::UPDATE</code></td><td><code>TransactionType::Update-&gt;value</code></td></tr><tr><td><code>Transaction::REMOVE</code></td><td><code>TransactionType::Remove-&gt;value</code></td></tr><tr><td><code>Transaction::ASSOCIATE</code></td><td><code>TransactionType::Associate-&gt;value</code></td></tr><tr><td><code>Transaction::DISSOCIATE</code></td><td><code>TransactionType::Dissociate-&gt;value</code></td></tr></tbody></table>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Model</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Transaction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$entry</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token class-name static-context">Transaction</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">INSERT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Model</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">TransactionType</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$entry</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">Insert</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-symfony-attributes">üéµ Symfony Attributes<a href="#-symfony-attributes" class="hash-link" aria-label="Direct link to üéµ Symfony Attributes" title="Direct link to üéµ Symfony Attributes" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="commands">Commands<a href="#commands" class="hash-link" aria-label="Direct link to Commands" title="Direct link to Commands" translate="no">‚Äã</a></h3>
<p>Console commands now use <code>#[AsCommand]</code> attribute:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name">AsCommand</span><span class="token attribute attribute-content punctuation" style="color:#393A34">(</span><span class="token attribute attribute-content"></span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attribute-content">    </span><span class="token attribute attribute-content attribute-class-name class-name">name</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content string single-quoted-string" style="color:#e3116c">&#x27;audit:schema:update&#x27;</span><span class="token attribute attribute-content punctuation" style="color:#393A34">,</span><span class="token attribute attribute-content"></span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attribute-content">    </span><span class="token attribute attribute-content attribute-class-name class-name">description</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content string single-quoted-string" style="color:#e3116c">&#x27;Update audit tables structure&#x27;</span><span class="token attribute attribute-content punctuation" style="color:#393A34">,</span><span class="token attribute attribute-content"></span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attribute-content"></span><span class="token attribute attribute-content punctuation" style="color:#393A34">)</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">UpdateSchemaCommand</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Command</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="event-listeners">Event Listeners<a href="#event-listeners" class="hash-link" aria-label="Direct link to Event Listeners" title="Direct link to Event Listeners" translate="no">‚Äã</a></h3>
<p>Event subscriber has been replaced by event listeners using <code>#[AsEventListener]</code>:</p>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">AuditEventSubscriber</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">EventSubscriberInterface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">getSubscribedEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword return-type" style="color:#00009f">array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name static-context">LifecycleEvent</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;onAuditEvent&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name">AsEventListener</span><span class="token attribute attribute-content punctuation" style="color:#393A34">(</span><span class="token attribute attribute-content attribute-class-name class-name">event</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content attribute-class-name class-name">LifecycleEvent</span><span class="token attribute attribute-content operator" style="color:#393A34">::</span><span class="token attribute attribute-content constant" style="color:#36acaa">class</span><span class="token attribute attribute-content punctuation" style="color:#393A34">,</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content attribute-class-name class-name">method</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content string single-quoted-string" style="color:#e3116c">&#x27;onAuditEvent&#x27;</span><span class="token attribute attribute-content punctuation" style="color:#393A34">)</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">AuditEventSubscriber</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">onAuditEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name type-declaration">LifecycleEvent</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword return-type" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-migration-example-getmigratetosql">üîÑ Migration Example: getMigrateToSql<a href="#-migration-example-getmigratetosql" class="hash-link" aria-label="Direct link to üîÑ Migration Example: getMigrateToSql" title="Direct link to üîÑ Migration Example: getMigrateToSql" translate="no">‚Äã</a></h2>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Persistence</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Helper</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">DoctrineHelper</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$sqls</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">DoctrineHelper</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">getMigrateToSql</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$connection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$fromSchema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$toSchema</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">DBAL</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Schema</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Comparator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$platform</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$connection</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getDatabasePlatform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$sqls</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$platform</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getAlterSchemaSQL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Comparator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$platform</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">compareSchemas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$fromSchema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$toSchema</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="doctrinehelpergetrealclassname">DoctrineHelper::getRealClassName()<a href="#doctrinehelpergetrealclassname" class="hash-link" aria-label="Direct link to DoctrineHelper::getRealClassName()" title="Direct link to DoctrineHelper::getRealClassName()" translate="no">‚Äã</a></h3>
<p>This method now only handles <code>__CG__</code> proxies (Doctrine Common Gateway marker).</p>
<p>With PHP 8.4+, Doctrine ORM uses native lazy objects instead of proxy classes, so the previous proxy handling logic has been simplified.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="composer-scripts-changes">Composer Scripts Changes<a href="#composer-scripts-changes" class="hash-link" aria-label="Direct link to Composer Scripts Changes" title="Direct link to Composer Scripts Changes" translate="no">‚Äã</a></h2>
<p>The following composer scripts have been removed:</p>
<table><thead><tr><th>Removed Script</th><th>Purpose</th></tr></thead><tbody><tr><td><code>setup5</code></td><td>Symfony 5.4 setup</td></tr><tr><td><code>setup6</code></td><td>Symfony 6.4 setup</td></tr><tr><td><code>setup7</code></td><td>Symfony 7.x setup</td></tr></tbody></table>
<p>Use the new unified <code>setup</code> script instead:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">composer</span><span class="token plain"> setup</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="internal-changes">Internal Changes<a href="#internal-changes" class="hash-link" aria-label="Direct link to Internal Changes" title="Direct link to Internal Changes" translate="no">‚Äã</a></h2>
<p>These changes are internal and should not affect most users, but are documented for completeness:</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="doctrinehelpersetprimarykey">DoctrineHelper::setPrimaryKey()<a href="#doctrinehelpersetprimarykey" class="hash-link" aria-label="Direct link to DoctrineHelper::setPrimaryKey()" title="Direct link to DoctrineHelper::setPrimaryKey()" translate="no">‚Äã</a></h3>
<p>Now uses <code>PrimaryKeyConstraint</code> directly without fallback to deprecated <code>setPrimaryKey()</code> method.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="doctrinehelpergetreflectionpropertyvalue">DoctrineHelper::getReflectionPropertyValue()<a href="#doctrinehelpergetreflectionpropertyvalue" class="hash-link" aria-label="Direct link to DoctrineHelper::getReflectionPropertyValue()" title="Direct link to DoctrineHelper::getReflectionPropertyValue()" translate="no">‚Äã</a></h3>
<p>Now uses <code>getPropertyAccessor()</code> directly without fallback to deprecated <code>getReflectionProperty()</code> method.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="platformhelpergetserverversion">PlatformHelper::getServerVersion()<a href="#platformhelpergetserverversion" class="hash-link" aria-label="Direct link to PlatformHelper::getServerVersion()" title="Direct link to PlatformHelper::getServerVersion()" translate="no">‚Äã</a></h3>
<p>Simplified to use <code>getNativeConnection()</code> directly. The <code>getWrappedConnection()</code> fallback has been removed.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-php-84-modernization-changes">üöÄ PHP 8.4+ Modernization Changes<a href="#-php-84-modernization-changes" class="hash-link" aria-label="Direct link to üöÄ PHP 8.4+ Modernization Changes" title="Direct link to üöÄ PHP 8.4+ Modernization Changes" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="transactiontype-enum">TransactionType Enum<a href="#transactiontype-enum" class="hash-link" aria-label="Direct link to TransactionType Enum" title="Direct link to TransactionType Enum" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-note" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>NOTE</p>
<p>Transaction type constants have been moved from <code>Transaction</code> model to a native PHP enum <code>TransactionType</code>.</p>
</div>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Model</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Transaction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">Transaction</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">INSERT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">Transaction</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">UPDATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">Transaction</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">REMOVE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">Transaction</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">ASSOCIATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">Transaction</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">DISSOCIATE</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Model</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">TransactionType</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Using constants (recommended - backward compatible syntax)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">INSERT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">UPDATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">REMOVE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">ASSOCIATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">DISSOCIATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Or using enum cases (when you need the enum instance)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">Insert</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">TransactionType</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">Update</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// etc.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="entry-model---property-hooks">Entry Model - Property Hooks<a href="#entry-model---property-hooks" class="hash-link" aria-label="Direct link to Entry Model - Property Hooks" title="Direct link to Entry Model - Property Hooks" translate="no">‚Äã</a></h3>
<p>The <code>Entry</code> model now uses PHP 8.4 property hooks. Getter methods have been replaced by direct property access.</p>
<table><thead><tr><th>Before (3.x)</th><th>After (4.0)</th></tr></thead><tbody><tr><td><code>$entry-&gt;getId()</code></td><td><code>$entry-&gt;id</code></td></tr><tr><td><code>$entry-&gt;getType()</code></td><td><code>$entry-&gt;type</code></td></tr><tr><td><code>$entry-&gt;getObjectId()</code></td><td><code>$entry-&gt;objectId</code></td></tr><tr><td><code>$entry-&gt;getDiscriminator()</code></td><td><code>$entry-&gt;discriminator</code></td></tr><tr><td><code>$entry-&gt;getTransactionHash()</code></td><td><code>$entry-&gt;transactionHash</code></td></tr><tr><td><code>$entry-&gt;getUserId()</code></td><td><code>$entry-&gt;userId</code></td></tr><tr><td><code>$entry-&gt;getUsername()</code></td><td><code>$entry-&gt;username</code></td></tr><tr><td><code>$entry-&gt;getUserFqdn()</code></td><td><code>$entry-&gt;userFqdn</code></td></tr><tr><td><code>$entry-&gt;getUserFirewall()</code></td><td><code>$entry-&gt;userFirewall</code></td></tr><tr><td><code>$entry-&gt;getIp()</code></td><td><code>$entry-&gt;ip</code></td></tr><tr><td><code>$entry-&gt;getCreatedAt()</code></td><td><code>$entry-&gt;createdAt</code></td></tr></tbody></table>
<blockquote>
<p><strong>Note:</strong> <code>getDiffs()</code> method is preserved as it contains business logic.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="user-interface---property-hooks">User Interface - Property Hooks<a href="#user-interface---property-hooks" class="hash-link" aria-label="Direct link to User Interface - Property Hooks" title="Direct link to User Interface - Property Hooks" translate="no">‚Äã</a></h3>
<p>The <code>UserInterface</code> now uses PHP 8.4 interface properties.</p>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name-definition class-name">UserInterface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">getIdentifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword return-type" style="color:#00009f">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">getUsername</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword return-type" style="color:#00009f">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Usage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$user</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getIdentifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$user</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">getUsername</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name-definition class-name">UserInterface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword type-hint" style="color:#00009f">string</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$identifier</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> get</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token keyword type-hint" style="color:#00009f">string</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$username</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> get</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Usage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$user</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">identifier</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$user</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">username</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration---asymmetric-visibility">Configuration - Asymmetric Visibility<a href="#configuration---asymmetric-visibility" class="hash-link" aria-label="Direct link to Configuration - Asymmetric Visibility" title="Direct link to Configuration - Asymmetric Visibility" translate="no">‚Äã</a></h3>
<p>The <code>Configuration</code> class now uses asymmetric visibility for some properties.</p>
<table><thead><tr><th>Before (3.x)</th><th>After (4.0)</th></tr></thead><tbody><tr><td><code>$config-&gt;isEnabled()</code></td><td><code>$config-&gt;enabled</code></td></tr><tr><td><code>$config-&gt;getTimezone()</code></td><td><code>$config-&gt;timezone</code></td></tr></tbody></table>
<blockquote>
<p><strong>Note:</strong> <code>getUserProvider()</code>, <code>getSecurityProvider()</code>, and <code>getRoleChecker()</code> methods are preserved.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="attribute-namespace-rename">Attribute Namespace Rename<a href="#attribute-namespace-rename" class="hash-link" aria-label="Direct link to Attribute Namespace Rename" title="Direct link to Attribute Namespace Rename" translate="no">‚Äã</a></h3>
<p>The <code>Annotation</code> namespace has been renamed to <code>Attribute</code> to better reflect PHP 8+ native attributes.</p>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Annotation</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditable</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Annotation</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Ignore</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Annotation</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Security</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Annotation</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">AnnotationLoader</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Attribute</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditable</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Attribute</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Ignore</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Attribute</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Security</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">DH</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditor</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Provider</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Doctrine</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Auditing</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Attribute</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">AttributeLoader</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="event-subscribers--event-listeners">Event Subscribers ‚Üí Event Listeners<a href="#event-subscribers--event-listeners" class="hash-link" aria-label="Direct link to Event Subscribers ‚Üí Event Listeners" title="Direct link to Event Subscribers ‚Üí Event Listeners" translate="no">‚Äã</a></h3>
<p>Event subscribers now use Symfony&#x27;s <code>#[AsEventListener]</code> attribute instead of <code>EventSubscriberInterface</code>.</p>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">Symfony</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Component</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">EventDispatcher</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">EventSubscriberInterface</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">AuditEventSubscriber</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">EventSubscriberInterface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">getSubscribedEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword return-type" style="color:#00009f">array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name static-context">LifecycleEvent</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;onAuditEvent&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">onAuditEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name type-declaration">LifecycleEvent</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name return-type">LifecycleEvent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* ... */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">Symfony</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Component</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">EventDispatcher</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">Attribute</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">AsEventListener</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name">AsEventListener</span><span class="token attribute attribute-content punctuation" style="color:#393A34">(</span><span class="token attribute attribute-content attribute-class-name class-name">event</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content attribute-class-name class-name">LifecycleEvent</span><span class="token attribute attribute-content operator" style="color:#393A34">::</span><span class="token attribute attribute-content constant" style="color:#36acaa">class</span><span class="token attribute attribute-content punctuation" style="color:#393A34">,</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content attribute-class-name class-name">priority</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content operator" style="color:#393A34">-</span><span class="token attribute attribute-content number" style="color:#36acaa">1_000_000</span><span class="token attribute attribute-content punctuation" style="color:#393A34">)</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">AuditEventSubscriber</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">__invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name type-declaration">LifecycleEvent</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name return-type">LifecycleEvent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* ... */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="console-commands-with-ascommand">Console Commands with <code>#[AsCommand]</code><a href="#console-commands-with-ascommand" class="hash-link" aria-label="Direct link to console-commands-with-ascommand" title="Direct link to console-commands-with-ascommand" translate="no">‚Äã</a></h3>
<p>Console commands now use the <code>#[AsCommand]</code> attribute for metadata.</p>
<p><strong>Before (3.x):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">CleanAuditLogsCommand</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">configure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword return-type" style="color:#00009f">void</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token variable" style="color:#36acaa">$this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">setName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;audit:clean&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">setDescription</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;Cleans audit tables&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>After (4.0):</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute delimiter punctuation" style="color:#393A34">#[</span><span class="token attribute attribute-content attribute-class-name class-name">AsCommand</span><span class="token attribute attribute-content punctuation" style="color:#393A34">(</span><span class="token attribute attribute-content attribute-class-name class-name">name</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content string single-quoted-string" style="color:#e3116c">&#x27;audit:clean&#x27;</span><span class="token attribute attribute-content punctuation" style="color:#393A34">,</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content attribute-class-name class-name">description</span><span class="token attribute attribute-content punctuation" style="color:#393A34">:</span><span class="token attribute attribute-content"> </span><span class="token attribute attribute-content string single-quoted-string" style="color:#e3116c">&#x27;Cleans audit tables&#x27;</span><span class="token attribute attribute-content punctuation" style="color:#393A34">)</span><span class="token attribute delimiter punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name-definition class-name">CleanAuditLogsCommand</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">protected</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">configure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword return-type" style="color:#00009f">void</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Only options and arguments, no setName/setDescription</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-migration-steps">üìã Migration Steps<a href="#-migration-steps" class="hash-link" aria-label="Direct link to üìã Migration Steps" title="Direct link to üìã Migration Steps" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1Ô∏è‚É£-update-php-version">1Ô∏è‚É£ Update PHP Version<a href="#1Ô∏è‚É£-update-php-version" class="hash-link" aria-label="Direct link to 1Ô∏è‚É£ Update PHP Version" title="Direct link to 1Ô∏è‚É£ Update PHP Version" translate="no">‚Äã</a></h3>
<p>Ensure you&#x27;re running PHP 8.4 or higher:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">php </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PHP 8.4.x ...</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2Ô∏è‚É£-update-symfony-dependencies">2Ô∏è‚É£ Update Symfony Dependencies<a href="#2Ô∏è‚É£-update-symfony-dependencies" class="hash-link" aria-label="Direct link to 2Ô∏è‚É£ Update Symfony Dependencies" title="Direct link to 2Ô∏è‚É£ Update Symfony Dependencies" translate="no">‚Äã</a></h3>
<p>Update your <code>composer.json</code>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;require&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;symfony/framework-bundle&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^8.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3Ô∏è‚É£-update-doctrine-dependencies">3Ô∏è‚É£ Update Doctrine Dependencies<a href="#3Ô∏è‚É£-update-doctrine-dependencies" class="hash-link" aria-label="Direct link to 3Ô∏è‚É£ Update Doctrine Dependencies" title="Direct link to 3Ô∏è‚É£ Update Doctrine Dependencies" translate="no">‚Äã</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;require&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;doctrine/dbal&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^4.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;doctrine/orm&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^3.2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="4Ô∏è‚É£-update-auditor">4Ô∏è‚É£ Update auditor<a href="#4Ô∏è‚É£-update-auditor" class="hash-link" aria-label="Direct link to 4Ô∏è‚É£ Update auditor" title="Direct link to 4Ô∏è‚É£ Update auditor" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">composer</span><span class="token plain"> require damienharper/auditor:^4.0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="5Ô∏è‚É£-update-your-code">5Ô∏è‚É£ Update Your Code<a href="#5Ô∏è‚É£-update-your-code" class="hash-link" aria-label="Direct link to 5Ô∏è‚É£ Update Your Code" title="Direct link to 5Ô∏è‚É£ Update Your Code" translate="no">‚Äã</a></h3>
<p>Replace any removed method calls:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Before</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$schemaManager</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">DoctrineHelper</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">createSchemaManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$connection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$schema</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name static-context">DoctrineHelper</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">introspectSchema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$schemaManager</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// After</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$schemaManager</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$connection</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">createSchemaManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$schema</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$schemaManager</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">introspectSchema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="6Ô∏è‚É£-run-tests">6Ô∏è‚É£ Run Tests<a href="#6Ô∏è‚É£-run-tests" class="hash-link" aria-label="Direct link to 6Ô∏è‚É£ Run Tests" title="Direct link to 6Ô∏è‚É£ Run Tests" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./vendor/bin/phpunit</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="7Ô∏è‚É£-update-audit-schema">7Ô∏è‚É£ Update Audit Schema<a href="#7Ô∏è‚É£-update-audit-schema" class="hash-link" aria-label="Direct link to 7Ô∏è‚É£ Update Audit Schema" title="Direct link to 7Ô∏è‚É£ Update Audit Schema" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-important" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>IMPORTANT</p>
<p>After upgrading, ensure your audit tables are up to date.</p>
</div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">php bin/console audit:schema:update --dump-sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">php bin/console audit:schema:update </span><span class="token parameter variable" style="color:#36acaa">--force</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-troubleshooting">üîß Troubleshooting<a href="#-troubleshooting" class="hash-link" aria-label="Direct link to üîß Troubleshooting" title="Direct link to üîß Troubleshooting" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="class-not-found-errors">&quot;Class not found&quot; errors<a href="#class-not-found-errors" class="hash-link" aria-label="Direct link to &quot;Class not found&quot; errors" title="Direct link to &quot;Class not found&quot; errors" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-tip" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>TIP</p>
<p>Ensure all dependencies are updated by running <code>composer update</code>.</p>
</div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="schema-issues">Schema issues<a href="#schema-issues" class="hash-link" aria-label="Direct link to Schema issues" title="Direct link to Schema issues" translate="no">‚Äã</a></h3>
<div class="markdown-alert markdown-alert-note" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>NOTE</p>
<p>Run the schema update command: <code>php bin/console audit:schema:update --force</code></p>
</div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="test-failures">Test failures<a href="#test-failures" class="hash-link" aria-label="Direct link to Test failures" title="Direct link to Test failures" translate="no">‚Äã</a></h3>
<p>If tests fail after upgrading:</p>
<ol>
<li class="">Check PHPUnit version compatibility</li>
<li class="">Review any mocked classes for API changes</li>
<li class="">Check for deprecated method usage</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-need-help">‚ùì Need Help?<a href="#-need-help" class="hash-link" aria-label="Direct link to ‚ùì Need Help?" title="Direct link to ‚ùì Need Help?" translate="no">‚Äã</a></h2>
<p>If you encounter issues during the upgrade:</p>
<ol>
<li class="">Check the <a href="https://github.com/DamienHarper/auditor/issues" target="_blank" rel="noopener noreferrer" class="">GitHub Issues</a></li>
<li class="">Review the <a href="https://github.com/DamienHarper/auditor/releases" target="_blank" rel="noopener noreferrer" class="">Release Notes</a></li>
<li class="">Open a new issue with:<!-- -->
<ul>
<li class="">PHP version</li>
<li class="">Symfony version</li>
<li class="">Error messages</li>
<li class="">Steps to reproduce</li>
</ul>
</li>
</ol></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/auditor-docs/auditor/upgrade/v3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Upgrading to 3.x from 2.x</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#Ô∏è-requirements-changes" class="table-of-contents__link toc-highlight">‚ö†Ô∏è Requirements Changes</a><ul><li><a href="#php-version" class="table-of-contents__link toc-highlight">PHP Version</a></li><li><a href="#symfony-version" class="table-of-contents__link toc-highlight">Symfony Version</a></li><li><a href="#doctrine-versions" class="table-of-contents__link toc-highlight">Doctrine Versions</a></li><li><a href="#phpunit-version" class="table-of-contents__link toc-highlight">PHPUnit Version</a></li></ul></li><li><a href="#Ô∏è-removed-methods" class="table-of-contents__link toc-highlight">üóëÔ∏è Removed Methods</a><ul><li><a href="#doctrinehelper" class="table-of-contents__link toc-highlight">DoctrineHelper</a></li></ul></li><li><a href="#-namespace-changes" class="table-of-contents__link toc-highlight">üì¶ Namespace Changes</a><ul><li><a href="#annotation--attribute" class="table-of-contents__link toc-highlight">Annotation ‚Üí Attribute</a></li></ul></li><li><a href="#-model-changes" class="table-of-contents__link toc-highlight">üìä Model Changes</a><ul><li><a href="#entry-model---property-hooks-php-84" class="table-of-contents__link toc-highlight">Entry Model - Property Hooks (PHP 8.4+)</a></li><li><a href="#configuration---asymmetric-visibility-php-84" class="table-of-contents__link toc-highlight">Configuration - Asymmetric Visibility (PHP 8.4+)</a></li><li><a href="#user-model---property-hooks-php-84" class="table-of-contents__link toc-highlight">User Model - Property Hooks (PHP 8.4+)</a></li></ul></li><li><a href="#-utf-8-conversion-now-opt-in" class="table-of-contents__link toc-highlight">üî° UTF-8 Conversion Now Opt-In</a><ul><li><a href="#what-changed" class="table-of-contents__link toc-highlight">What Changed</a></li><li><a href="#who-is-affected" class="table-of-contents__link toc-highlight">Who Is Affected</a></li><li><a href="#how-to-fix" class="table-of-contents__link toc-highlight">How to Fix</a></li><li><a href="#why-the-default-is-false" class="table-of-contents__link toc-highlight">Why the Default Is <code>false</code></a></li></ul></li><li><a href="#-new-extra_data-column" class="table-of-contents__link toc-highlight">üÜï New <code>extra_data</code> Column</a><ul><li><a href="#schema-change" class="table-of-contents__link toc-highlight">Schema Change</a></li><li><a href="#two-ways-to-populate-extra_data" class="table-of-contents__link toc-highlight">Two ways to populate <code>extra_data</code></a></li></ul></li><li><a href="#-transactiontype-enum" class="table-of-contents__link toc-highlight">üî¢ TransactionType Enum</a></li><li><a href="#-symfony-attributes" class="table-of-contents__link toc-highlight">üéµ Symfony Attributes</a><ul><li><a href="#commands" class="table-of-contents__link toc-highlight">Commands</a></li><li><a href="#event-listeners" class="table-of-contents__link toc-highlight">Event Listeners</a></li></ul></li><li><a href="#-migration-example-getmigratetosql" class="table-of-contents__link toc-highlight">üîÑ Migration Example: getMigrateToSql</a><ul><li><a href="#doctrinehelpergetrealclassname" class="table-of-contents__link toc-highlight">DoctrineHelper::getRealClassName()</a></li></ul></li><li><a href="#composer-scripts-changes" class="table-of-contents__link toc-highlight">Composer Scripts Changes</a></li><li><a href="#internal-changes" class="table-of-contents__link toc-highlight">Internal Changes</a><ul><li><a href="#doctrinehelpersetprimarykey" class="table-of-contents__link toc-highlight">DoctrineHelper::setPrimaryKey()</a></li><li><a href="#doctrinehelpergetreflectionpropertyvalue" class="table-of-contents__link toc-highlight">DoctrineHelper::getReflectionPropertyValue()</a></li><li><a href="#platformhelpergetserverversion" class="table-of-contents__link toc-highlight">PlatformHelper::getServerVersion()</a></li></ul></li><li><a href="#-php-84-modernization-changes" class="table-of-contents__link toc-highlight">üöÄ PHP 8.4+ Modernization Changes</a><ul><li><a href="#transactiontype-enum" class="table-of-contents__link toc-highlight">TransactionType Enum</a></li><li><a href="#entry-model---property-hooks" class="table-of-contents__link toc-highlight">Entry Model - Property Hooks</a></li><li><a href="#user-interface---property-hooks" class="table-of-contents__link toc-highlight">User Interface - Property Hooks</a></li><li><a href="#configuration---asymmetric-visibility" class="table-of-contents__link toc-highlight">Configuration - Asymmetric Visibility</a></li><li><a href="#attribute-namespace-rename" class="table-of-contents__link toc-highlight">Attribute Namespace Rename</a></li><li><a href="#event-subscribers--event-listeners" class="table-of-contents__link toc-highlight">Event Subscribers ‚Üí Event Listeners</a></li><li><a href="#console-commands-with-ascommand" class="table-of-contents__link toc-highlight">Console Commands with <code>#[AsCommand]</code></a></li></ul></li><li><a href="#-migration-steps" class="table-of-contents__link toc-highlight">üìã Migration Steps</a><ul><li><a href="#1Ô∏è‚É£-update-php-version" class="table-of-contents__link toc-highlight">1Ô∏è‚É£ Update PHP Version</a></li><li><a href="#2Ô∏è‚É£-update-symfony-dependencies" class="table-of-contents__link toc-highlight">2Ô∏è‚É£ Update Symfony Dependencies</a></li><li><a href="#3Ô∏è‚É£-update-doctrine-dependencies" class="table-of-contents__link toc-highlight">3Ô∏è‚É£ Update Doctrine Dependencies</a></li><li><a href="#4Ô∏è‚É£-update-auditor" class="table-of-contents__link toc-highlight">4Ô∏è‚É£ Update auditor</a></li><li><a href="#5Ô∏è‚É£-update-your-code" class="table-of-contents__link toc-highlight">5Ô∏è‚É£ Update Your Code</a></li><li><a href="#6Ô∏è‚É£-run-tests" class="table-of-contents__link toc-highlight">6Ô∏è‚É£ Run Tests</a></li><li><a href="#7Ô∏è‚É£-update-audit-schema" class="table-of-contents__link toc-highlight">7Ô∏è‚É£ Update Audit Schema</a></li></ul></li><li><a href="#-troubleshooting" class="table-of-contents__link toc-highlight">üîß Troubleshooting</a><ul><li><a href="#class-not-found-errors" class="table-of-contents__link toc-highlight">&quot;Class not found&quot; errors</a></li><li><a href="#schema-issues" class="table-of-contents__link toc-highlight">Schema issues</a></li><li><a href="#test-failures" class="table-of-contents__link toc-highlight">Test failures</a></li></ul></li><li><a href="#-need-help" class="table-of-contents__link toc-highlight">‚ùì Need Help?</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">auditor</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/auditor-docs/auditor/intro">Documentation (4.x)</a></li><li class="footer__item"><a href="https://github.com/DamienHarper/auditor" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">auditor-bundle</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/auditor-docs/auditor-bundle/intro">Documentation (7.x)</a></li><li class="footer__item"><a href="https://github.com/DamienHarper/auditor-bundle" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2026 Damien Harper. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>